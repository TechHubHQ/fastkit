"""{{ domain_name.title() }} domain routes."""

from fastapi import APIRouter, Depends, HTTPException, status, Query
from typing import List, Union
from .services import {{ domain_name.title() }}Service
from .schemas import {{ domain_name.title() }}Create, {{ domain_name.title() }}Update, {{ domain_name.title() }}Response
from .dependencies import get_{{ domain_name.lower() }}_service
from .exceptions import {{ domain_name.title() }}NotFound, {{ domain_name.title() }}AlreadyExists

router = APIRouter(prefix="/{{ domain_name.lower() }}", tags=["{{ domain_name.lower() }}"])


@router.get("/", response_model=List[{{ domain_name.title() }}Response])
async def get_all_{{ domain_name.lower() }}s(
    skip: int = Query(0, ge=0, description="Number of records to skip"),
    limit: int = Query(100, ge=1, le=1000, description="Number of records to return"),
    active_only: bool = Query(True, description="Filter only active records"),
    service: {{ domain_name.title() }}Service = Depends(get_{{ domain_name.lower() }}_service)
):
    """Get all {{ domain_name.lower() }} records with pagination."""
    return await service.get_all_{{ domain_name.lower() }}s(skip=skip, limit=limit, active_only=active_only)


@router.get("/count")
async def get_{{ domain_name.lower() }}s_count(
    active_only: bool = Query(True, description="Count only active records"),
    service: {{ domain_name.title() }}Service = Depends(get_{{ domain_name.lower() }}_service)
):
    """Get the count of {{ domain_name.lower() }} records."""
    count = await service.get_{{ domain_name.lower() }}s_count(active_only=active_only)
    return {"count": count}


@router.get("/name/{name}", response_model={{ domain_name.title() }}Response)
async def get_{{ domain_name.lower() }}_by_name(
    name: str,
    service: {{ domain_name.title() }}Service = Depends(get_{{ domain_name.lower() }}_service)
):
    """Get a {{ domain_name.lower() }} by name."""
    try:
        return await service.get_{{ domain_name.lower() }}_by_name(name)
    except {{ domain_name.title() }}NotFound as e:
        raise HTTPException(status_code=status.HTTP_404_NOT_FOUND, detail=str(e))


@router.get("/{{ '{' }}{{ domain_name.lower() }}_id{{ '}' }}", response_model={{ domain_name.title() }}Response)
async def get_{{ domain_name.lower() }}(
    {{ domain_name.lower() }}_id: str,
    service: {{ domain_name.title() }}Service = Depends(get_{{ domain_name.lower() }}_service)
):
    """Get a {{ domain_name.lower() }} by ID."""
    try:
        return await service.get_{{ domain_name.lower() }}({{ domain_name.lower() }}_id)
    except {{ domain_name.title() }}NotFound as e:
        raise HTTPException(status_code=status.HTTP_404_NOT_FOUND, detail=str(e))


@router.post("/", response_model={{ domain_name.title() }}Response, status_code=status.HTTP_201_CREATED)
async def create_{{ domain_name.lower() }}(
    {{ domain_name.lower() }}_data: {{ domain_name.title() }}Create,
    service: {{ domain_name.title() }}Service = Depends(get_{{ domain_name.lower() }}_service)
):
    """Create a new {{ domain_name.lower() }}."""
    try:
        return await service.create_{{ domain_name.lower() }}({{ domain_name.lower() }}_data)
    except {{ domain_name.title() }}AlreadyExists as e:
        raise HTTPException(status_code=status.HTTP_400_BAD_REQUEST, detail=str(e))


@router.put("/{{ '{' }}{{ domain_name.lower() }}_id{{ '}' }}", response_model={{ domain_name.title() }}Response)
async def update_{{ domain_name.lower() }}(
    {{ domain_name.lower() }}_id: str,
    {{ domain_name.lower() }}_data: {{ domain_name.title() }}Update,
    service: {{ domain_name.title() }}Service = Depends(get_{{ domain_name.lower() }}_service)
):
    """Update a {{ domain_name.lower() }}."""
    try:
        return await service.update_{{ domain_name.lower() }}({{ domain_name.lower() }}_id, {{ domain_name.lower() }}_data)
    except {{ domain_name.title() }}NotFound as e:
        raise HTTPException(status_code=status.HTTP_404_NOT_FOUND, detail=str(e))
    except {{ domain_name.title() }}AlreadyExists as e:
        raise HTTPException(status_code=status.HTTP_400_BAD_REQUEST, detail=str(e))


@router.patch("/{{ '{' }}{{ domain_name.lower() }}_id{{ '}' }}/activate", response_model={{ domain_name.title() }}Response)
async def activate_{{ domain_name.lower() }}(
    {{ domain_name.lower() }}_id: str,
    service: {{ domain_name.title() }}Service = Depends(get_{{ domain_name.lower() }}_service)
):
    """Activate a {{ domain_name.lower() }}."""
    try:
        return await service.activate_{{ domain_name.lower() }}({{ domain_name.lower() }}_id)
    except {{ domain_name.title() }}NotFound as e:
        raise HTTPException(status_code=status.HTTP_404_NOT_FOUND, detail=str(e))


@router.patch("/{{ '{' }}{{ domain_name.lower() }}_id{{ '}' }}/deactivate", response_model={{ domain_name.title() }}Response)
async def deactivate_{{ domain_name.lower() }}(
    {{ domain_name.lower() }}_id: str,
    service: {{ domain_name.title() }}Service = Depends(get_{{ domain_name.lower() }}_service)
):
    """Deactivate a {{ domain_name.lower() }}."""
    try:
        return await service.deactivate_{{ domain_name.lower() }}({{ domain_name.lower() }}_id)
    except {{ domain_name.title() }}NotFound as e:
        raise HTTPException(status_code=status.HTTP_404_NOT_FOUND, detail=str(e))


@router.delete("/{{ '{' }}{{ domain_name.lower() }}_id{{ '}' }}", status_code=status.HTTP_204_NO_CONTENT)
async def delete_{{ domain_name.lower() }}(
    {{ domain_name.lower() }}_id: str,
    service: {{ domain_name.title() }}Service = Depends(get_{{ domain_name.lower() }}_service)
):
    """Delete a {{ domain_name.lower() }}."""
    try:
        await service.delete_{{ domain_name.lower() }}({{ domain_name.lower() }}_id)
    except {{ domain_name.title() }}NotFound as e:
        raise HTTPException(status_code=status.HTTP_404_NOT_FOUND, detail=str(e))